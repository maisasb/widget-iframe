{"remainingRequest":"/home/track/workplace/a2/frontend/widget/node_modules/thread-loader/dist/cjs.js!/home/track/workplace/a2/frontend/widget/node_modules/babel-loader/lib/index.js!/home/track/workplace/a2/frontend/widget/node_modules/eslint-loader/index.js??ref--13-0!/home/track/workplace/a2/frontend/widget/src/hooks/iframe.js","dependencies":[{"path":"/home/track/workplace/a2/frontend/widget/src/hooks/iframe.js","mtime":1618838230181},{"path":"/home/track/workplace/a2/frontend/widget/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/track/workplace/a2/frontend/widget/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/track/workplace/a2/frontend/widget/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/track/workplace/a2/frontend/widget/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2guanMiOwppbXBvcnQgc3RvcmUgZnJvbSAnLi4vc3RvcmUnOwpleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VJZnJhbWVDb250cm9sKCkgewogIGZ1bmN0aW9uIGdldFRva2VuS2V5KCkgewogICAgdmFyIF9xdWVyeSRnZXQsIF9xdWVyeSRnZXQyOwoKICAgIHZhciBxdWVyeSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CiAgICB2YXIgYXBpS2V5ID0gKF9xdWVyeSRnZXQgPSBxdWVyeS5nZXQoJ2tleScpKSAhPT0gbnVsbCAmJiBfcXVlcnkkZ2V0ICE9PSB2b2lkIDAgPyBfcXVlcnkkZ2V0IDogJyc7CiAgICB2YXIgZWRpdCA9IChfcXVlcnkkZ2V0MiA9IHF1ZXJ5LmdldCgnZWRpdCcpKSAhPT0gbnVsbCAmJiBfcXVlcnkkZ2V0MiAhPT0gdm9pZCAwID8gX3F1ZXJ5JGdldDIgOiAnJzsKICAgIHN0b3JlLmNvbW1pdCgnc3VydmV5L3NldFRva2VuJywgYXBpS2V5KTsKICAgIHN0b3JlLmNvbW1pdCgnc3VydmV5L3NldEVkaXRNb2RlJywgZWRpdCk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVEYXRhTGlzdGVuZXIoKSB7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoIWV2ZW50LmRhdGEuaXNXaWRnZXQpIHJldHVybjsKCiAgICAgIGlmIChldmVudC5kYXRhLmN1c3RvbWVyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXZlbnQuZGF0YS5jdXN0b21lcik7CiAgICAgICAgc3RvcmUuY29tbWl0KCdzdXJ2ZXkvc2V0Q3VzdG9tZXInLCBldmVudC5kYXRhLmN1c3RvbWVyKTsKICAgICAgfQoKICAgICAgaWYgKGV2ZW50LmRhdGEuaW50ZXJhY3Rpb24pIHsKICAgICAgICBzdG9yZS5jb21taXQoJ3N1cnZleS9zZXRJbnRlcmFjdGlvbicsIGV2ZW50LmRhdGEuaW50ZXJhY3Rpb24pOwogICAgICB9CiAgICB9KTsKICB9CgogIHJldHVybiB7CiAgICB1cGRhdGVEYXRhTGlzdGVuZXI6IHVwZGF0ZURhdGFMaXN0ZW5lciwKICAgIGdldFRva2VuS2V5OiBnZXRUb2tlbktleQogIH07Cn0="},{"version":3,"sources":["/home/track/workplace/a2/frontend/widget/src/hooks/iframe.js"],"names":["store","useIframeControl","getTokenKey","query","URLSearchParams","window","location","search","apiKey","get","edit","commit","updateDataListener","addEventListener","event","data","isWidget","customer","console","log","interaction"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AAEA,eAAe,SAASC,gBAAT,GAA6B;AACxC,WAASC,WAAT,GAAwB;AAAA;;AACpB,QAAMC,KAAK,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAd;AACA,QAAMC,MAAM,iBAAGL,KAAK,CAACM,GAAN,CAAU,KAAV,CAAH,mDAAuB,EAAnC;AACA,QAAMC,IAAI,kBAAGP,KAAK,CAACM,GAAN,CAAU,MAAV,CAAH,qDAAwB,EAAlC;AACAT,IAAAA,KAAK,CAACW,MAAN,CAAa,iBAAb,EAAgCH,MAAhC;AACAR,IAAAA,KAAK,CAACW,MAAN,CAAa,oBAAb,EAAmCD,IAAnC;AACH;;AAED,WAASE,kBAAT,GAA+B;AAC3BP,IAAAA,MAAM,CAACQ,gBAAP,CAAwB,SAAxB,EAAmC,UAACC,KAAD,EAAW;AAC1C,UAAI,CAACA,KAAK,CAACC,IAAN,CAAWC,QAAhB,EAA0B;;AAE1B,UAAIF,KAAK,CAACC,IAAN,CAAWE,QAAf,EAAyB;AACrBC,QAAAA,OAAO,CAACC,GAAR,CAAYL,KAAK,CAACC,IAAN,CAAWE,QAAvB;AACAjB,QAAAA,KAAK,CAACW,MAAN,CAAa,oBAAb,EAAmCG,KAAK,CAACC,IAAN,CAAWE,QAA9C;AACH;;AACD,UAAIH,KAAK,CAACC,IAAN,CAAWK,WAAf,EAA4B;AACxBpB,QAAAA,KAAK,CAACW,MAAN,CAAa,uBAAb,EAAsCG,KAAK,CAACC,IAAN,CAAWK,WAAjD;AACH;AACJ,KAVD;AAWH;;AAED,SAAO;AACHR,IAAAA,kBAAkB,EAAlBA,kBADG;AAEHV,IAAAA,WAAW,EAAXA;AAFG,GAAP;AAIH","sourcesContent":["import store from '../store'\n\nexport default function useIframeControl () {\n    function getTokenKey () {\n        const query = new URLSearchParams(window.location.search)\n        const apiKey = query.get('key') ?? ''\n        const edit = query.get('edit') ?? ''\n        store.commit('survey/setToken', apiKey)\n        store.commit('survey/setEditMode', edit)\n    }\n\n    function updateDataListener () {\n        window.addEventListener('message', (event) => {\n            if (!event.data.isWidget) return\n\n            if (event.data.customer) {\n                console.log(event.data.customer)\n                store.commit('survey/setCustomer', event.data.customer)\n            }\n            if (event.data.interaction) {\n                store.commit('survey/setInteraction', event.data.interaction)\n            }\n        })\n    }\n\n    return {\n        updateDataListener,\n        getTokenKey\n    }\n}"]}]}