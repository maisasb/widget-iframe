{"remainingRequest":"/home/track/workplace/widget-iframe/node_modules/babel-loader/lib/index.js!/home/track/workplace/widget-iframe/node_modules/eslint-loader/index.js??ref--13-0!/home/track/workplace/widget-iframe/src/hooks/iframe.js","dependencies":[{"path":"/home/track/workplace/widget-iframe/src/hooks/iframe.js","mtime":1629149016412},{"path":"/home/track/workplace/widget-iframe/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/track/workplace/widget-iframe/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/track/workplace/widget-iframe/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoLmpzIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4uL3N0b3JlIjsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlSWZyYW1lQ29udHJvbCgpIHsKICBmdW5jdGlvbiBnZXRUb2tlbktleSgpIHsKICAgIHZhciBfcXVlcnkkZ2V0OwoKICAgIHZhciBxdWVyeSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CiAgICB2YXIgYXBpS2V5ID0gKF9xdWVyeSRnZXQgPSBxdWVyeS5nZXQoImtleSIpKSAhPT0gbnVsbCAmJiBfcXVlcnkkZ2V0ICE9PSB2b2lkIDAgPyBfcXVlcnkkZ2V0IDogIlRFU1RFX0RFViI7CiAgICBzdG9yZS5jb21taXQoIndpZGdldC9zZXRUb2tlbiIsIGFwaUtleSk7CiAgfQoKICBmdW5jdGlvbiB1cGRhdGVEYXRhTGlzdGVuZXIoKSB7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoIWV2ZW50LmRhdGEuaXNXaWRnZXQpIHJldHVybjsKCiAgICAgIGlmIChldmVudC5kYXRhLmN1c3RvbWVyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXZlbnQuZGF0YS5jdXN0b21lcik7CiAgICAgICAgc3RvcmUuY29tbWl0KCJ3aWRnZXQvc2V0Q3VzdG9tZXIiLCBldmVudC5kYXRhLmN1c3RvbWVyKTsKICAgICAgfQoKICAgICAgaWYgKGV2ZW50LmRhdGEuaW50ZXJhY3Rpb24pIHsKICAgICAgICBzdG9yZS5jb21taXQoIndpZGdldC9zZXRJbnRlcmFjdGlvbiIsIGV2ZW50LmRhdGEuaW50ZXJhY3Rpb24pOwogICAgICB9CiAgICB9KTsKICB9CgogIHJldHVybiB7CiAgICB1cGRhdGVEYXRhTGlzdGVuZXI6IHVwZGF0ZURhdGFMaXN0ZW5lciwKICAgIGdldFRva2VuS2V5OiBnZXRUb2tlbktleQogIH07Cn0="},{"version":3,"sources":["/home/track/workplace/widget-iframe/src/hooks/iframe.js"],"names":["store","useIframeControl","getTokenKey","query","URLSearchParams","window","location","search","apiKey","get","commit","updateDataListener","addEventListener","event","data","isWidget","customer","console","log","interaction"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AAEA,eAAe,SAASC,gBAAT,GAA4B;AACzC,WAASC,WAAT,GAAuB;AAAA;;AACrB,QAAMC,KAAK,GAAG,IAAIC,eAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,CAAd;AACA,QAAMC,MAAM,iBAAGL,KAAK,CAACM,GAAN,CAAU,KAAV,CAAH,mDAAuB,WAAnC;AACAT,IAAAA,KAAK,CAACU,MAAN,CAAa,iBAAb,EAAgCF,MAAhC;AACD;;AAED,WAASG,kBAAT,GAA8B;AAC5BN,IAAAA,MAAM,CAACO,gBAAP,CAAwB,SAAxB,EAAmC,UAACC,KAAD,EAAW;AAC5C,UAAI,CAACA,KAAK,CAACC,IAAN,CAAWC,QAAhB,EAA0B;;AAE1B,UAAIF,KAAK,CAACC,IAAN,CAAWE,QAAf,EAAyB;AACvBC,QAAAA,OAAO,CAACC,GAAR,CAAYL,KAAK,CAACC,IAAN,CAAWE,QAAvB;AACAhB,QAAAA,KAAK,CAACU,MAAN,CAAa,oBAAb,EAAmCG,KAAK,CAACC,IAAN,CAAWE,QAA9C;AACD;;AACD,UAAIH,KAAK,CAACC,IAAN,CAAWK,WAAf,EAA4B;AAC1BnB,QAAAA,KAAK,CAACU,MAAN,CAAa,uBAAb,EAAsCG,KAAK,CAACC,IAAN,CAAWK,WAAjD;AACD;AACF,KAVD;AAWD;;AAED,SAAO;AACLR,IAAAA,kBAAkB,EAAlBA,kBADK;AAELT,IAAAA,WAAW,EAAXA;AAFK,GAAP;AAID","sourcesContent":["import store from \"../store\";\n\nexport default function useIframeControl() {\n  function getTokenKey() {\n    const query = new URLSearchParams(window.location.search);\n    const apiKey = query.get(\"key\") ?? \"TESTE_DEV\";\n    store.commit(\"widget/setToken\", apiKey);\n  }\n\n  function updateDataListener() {\n    window.addEventListener(\"message\", (event) => {\n      if (!event.data.isWidget) return;\n\n      if (event.data.customer) {\n        console.log(event.data.customer);\n        store.commit(\"widget/setCustomer\", event.data.customer);\n      }\n      if (event.data.interaction) {\n        store.commit(\"widget/setInteraction\", event.data.interaction);\n      }\n    });\n  }\n\n  return {\n    updateDataListener,\n    getTokenKey\n  };\n}\n"]}]}